-- TOTAIS DE ATENDIMENTO DE SUPORTE
SELECT 
      CASE
          WHEN DATA BETWEEN '2010-01-01' AND '2010-12-31' THEN '2010'
          WHEN DATA BETWEEN '2011-01-01' AND '2011-12-31' THEN '2011'
          WHEN DATA BETWEEN '2012-01-01' AND '2012-12-31' THEN '2012'
          WHEN DATA BETWEEN '2013-01-01' AND '2013-12-31' THEN '2013' 
	      WHEN DATA BETWEEN '2014-01-01' AND '2014-12-31' THEN '2014'
	      WHEN DATA BETWEEN '2015-01-01' AND '2015-12-31' THEN '2015'
	      WHEN DATA BETWEEN '2016-01-01' AND '2016-12-31' THEN '2016'
	      ELSE 'OUTROS'
      END "ANO",
      COUNT(1) AS "TOTAL ATENDIMENTOS"
FROM NS.FOLLOWUPS      	
WHERE DATA BETWEEN '2010-01-01' AND '2016-12-31' 
AND TIPOFOLLOWUP IN (SELECT TIPOFOLLOWUP FROM NS.TIPOSFOLLOWUPS WHERE CODIGO ILIKE 'S%')
AND DEPARTAMENTO IN (SELECT DEPARTAMENTOUSUARIO FROM NS.DEPARTAMENTOSUSUARIOS WHERE SIGLA = 'SUP')
AND USUARIO IN (SELECT USUARIO FROM NS.USUARIOS WHERE REPRESENTANTE IS NULL)
GROUP BY 1
ORDER BY "ANO";  


-- OUTRA OPÇÃO CONSIDERANDO O DEPARTAMENTO DO CADASTRO DO USUÁRIO
-- TOTAIS DE ATENDIMENTO DE SUPORTE
SELECT 
      CASE
          WHEN DATA BETWEEN '2010-01-01' AND '2010-12-31' THEN '2010'
          WHEN DATA BETWEEN '2011-01-01' AND '2011-12-31' THEN '2011'
          WHEN DATA BETWEEN '2012-01-01' AND '2012-12-31' THEN '2012'
          WHEN DATA BETWEEN '2013-01-01' AND '2013-12-31' THEN '2013' 
	      WHEN DATA BETWEEN '2014-01-01' AND '2014-12-31' THEN '2014'
	      WHEN DATA BETWEEN '2015-01-01' AND '2015-12-31' THEN '2015'
	      WHEN DATA BETWEEN '2016-01-01' AND '2016-12-31' THEN '2016'
	      ELSE 'OUTROS'
      END "ANO",
      COUNT(1) AS "TOTAL ATENDIMENTOS"
FROM NS.FOLLOWUPS      	
WHERE DATA BETWEEN '2010-01-01' AND '2016-12-31' 
AND TIPOFOLLOWUP IN (SELECT TIPOFOLLOWUP FROM NS.TIPOSFOLLOWUPS WHERE CODIGO ILIKE 'S%')
AND USUARIO IN (SELECT USUARIO FROM NS.USUARIOS WHERE REPRESENTANTE IS NULL AND DEPARTAMENTO = '19eb0727-a506-4efa-ac77-5b75999b04f5') -- SUPORTE
GROUP BY 1
ORDER BY "ANO";      